@use '@carbon/colors' as *;
@use '@carbon/react/scss/spacing' as *;
@use '@carbon/react/scss/theme' as *;
@use '@carbon/react' as react;

.kpi-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: $spacing-06;
    margin-bottom: $spacing-06;

    @media (max-width: 1056px) {
        grid-template-columns: repeat(2, 1fr);
    }

    @media (max-width: 672px) {
        grid-template-columns: 1fr;
    }
}

.kpi-card {
    position: relative;
    display: flex;
    align-items: flex-start;
    gap: $spacing-04;
    padding: $spacing-05;
    min-height: 120px;
    background: $layer-01;
    border-radius: 0;
    transition: box-shadow 0.2s ease;

    &:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    // Border colors
    &--bordered {
        border-left: 3px solid transparent;
    }

    &--border-red {
        border-left-color: $red-60;
    }

    &--border-orange {
        border-left-color: $orange-40;
    }

    &--border-yellow {
        border-left-color: $yellow-30;
    }

    &--border-green {
        border-left-color: $green-50;
    }

    &--border-blue {
        border-left-color: $blue-60;
    }

    &--border-purple {
        border-left-color: $purple-50;
    }

    &--border-teal {
        border-left-color: $teal-50;
    }

    // TOP RIGHT BADGE
    &__badge {
        position: absolute;
        top: $spacing-03;
        right: $spacing-03;
        z-index: 2; // Ensure it stays on top

        .cds--tag {
            margin: 0;
        }
    }

    // ICONS LEFT SIDE - CONCENTRIC CIRCLES
    &__icon {
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;

        &-outer {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
        }

        &-inner {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        // ALL COLORS SAME STRUCTURE
        &--blue .kpi-card__icon-outer {
            background: rgba($blue-60, 0.1); // Reduced opacity
        }

        &--blue .kpi-card__icon-inner {
            background: rgba($blue-60, 0.15);
            color: $blue-60;
        }

        &--red .kpi-card__icon-outer {
            background: rgba($red-60, 0.1);
        }

        &--red .kpi-card__icon-inner {
            background: rgba($red-60, 0.15);
            color: $red-60;
        }

        &--orange .kpi-card__icon-outer {
            background: rgba($orange-40, 0.1);
        }

        &--orange .kpi-card__icon-inner {
            background: rgba($orange-40, 0.15);
            color: $orange-40;
        }

        &--yellow .kpi-card__icon-outer {
            background: rgba($yellow-30, 0.1);
        }

        &--yellow .kpi-card__icon-inner {
            background: rgba($yellow-30, 0.15);
            color: $yellow-30;
        }

        &--green .kpi-card__icon-outer {
            background: rgba($green-50, 0.1);
        }

        &--green .kpi-card__icon-inner {
            background: rgba($green-50, 0.15);
            color: $green-50;
        }

        &--purple .kpi-card__icon-outer {
            background: rgba($purple-50, 0.1);
        }

        &--purple .kpi-card__icon-inner {
            background: rgba($purple-50, 0.15);
            color: $purple-50;
        }

        &--teal .kpi-card__icon-outer {
            background: rgba($teal-50, 0.1);
        }

        &--teal .kpi-card__icon-inner {
            background: rgba($teal-50, 0.15);
            color: $teal-50;
        }
    }

    // CONTENT
    &__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-width: 0;
        position: relative; // Ensure z-index works if needed
    }

    &__label {
        @include react.type-style('label-01');
        color: $text-secondary;
        text-transform: uppercase;
        margin-bottom: $spacing-01;
    }

    &__value {
        @include react.type-style('heading-04');
        margin: 0 0 $spacing-01 0;
        color: $text-primary;
    }

    &__subtitle {
        @include react.type-style('body-compact-01');
        color: $text-secondary;
    }

    &__footnote {
        @include react.type-style('helper-text-01');
        color: $text-secondary;
        margin-top: auto; // Push to bottom if height allows
        padding-top: $spacing-03;
    }

    &__trend {
        @include react.type-style('label-01');
        display: flex;
        align-items: center;
        gap: $spacing-02;
        margin-top: $spacing-02;

        &--positive {
            color: $green-50;
        }

        &--negative {
            color: $red-60;
        }

        &--neutral {
            color: $text-secondary;
        }
    }
}


// Skeleton Loading States
.kpi-card--skeleton {
    .kpi-card__content {
        display: flex;
        flex-direction: column;
        gap: $spacing-03;
        width: 100%;
    }

    .skeleton-line {
        background: linear-gradient(90deg, $layer-02 25%, $layer-hover-02 50%, $layer-02 75%);
        background-size: 200% 100%;
        animation: skeleton-shimmer 1.5s infinite;
        border-radius: 4px;

        &--sm {
            height: 12px;
            width: 40%;
        }

        &--md {
            height: 16px;
            width: 60%;
        }

        &--lg {
            height: 32px;
            width: 50%;
        }
    }
}

@keyframes skeleton-shimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}
