/**
 * Copyright IBM Corp. 2026
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */

@use '@carbon/react' with (
  $css--font-face: true,
  $css--body: true
);
@use '@carbon/react/scss/spacing' as *;
@use '@carbon/react/scss/theme' as *;
@use '@carbon/react/scss/themes';
@use '@carbon/react/scss/colors' as *;

/* Importing the component styles here will load them
   before the JavaScript, which will make the page
   not "flashing style" - everything will be at the right
   place from the start. In most case, avoid loading styles
   from the JavaScript. */

@mixin light-brand {
  --light: 'true';
  --cs-brand: #{$blue-30};
  --cs-brand-alt: #{$blue-20};
  --cs-logo-filter: invert(100%);

  background-color: $background;
  color: $text-primary;
}

@mixin dark-brand {
  --light: 'false';
  --cs-brand: #{$blue-80};
  --cs-brand-alt: #{$blue-90};
  --cs-logo-filter: initial;

  background: $background;
  color: $text-primary;
}

/* Theme based on data-theme-setting attribute */

// Base mixin to apply theme and brand styles
@mixin apply-theme($theme: 'light') {
  @if $theme =='light' {
    @include theme(themes.$g10);
    @include light-brand;
  }

  @else {
    @include theme(themes.$g100);
    @include dark-brand;
  }
}

// Helper mixins to apply theme to root or content
@mixin apply-root-theme($theme: 'light') {
  @include apply-theme($theme);
}

@mixin apply-content-theme($theme: 'light') {
  .cs--content {
    @include apply-theme($theme);
  }
}

// System theme (no explicit setting or explicit 'system' value)
$system-selector: ':root:is(:not([data-theme-setting]), [data-theme-setting="system"])';

// Default: dark header, light content (when header-inverse=true)
#{$system-selector}[data-header-inverse='true'] {
  @include apply-root-theme('dark');
  @include apply-content-theme('light');
}

// Default: light everywhere (when header-inverse=false or not set)
#{$system-selector}:not([data-header-inverse='true']) {
  @include apply-root-theme('light');
}

// System theme with dark preference
@media (prefers-color-scheme: dark) {

  // Light header, dark content (when header-inverse=true)
  #{$system-selector}[data-header-inverse='true'] {
    @include apply-root-theme('light');
    @include apply-content-theme('dark');
  }

  // Dark everywhere (when header-inverse=false or not set)
  #{$system-selector}:not([data-header-inverse='true']) {
    @include apply-root-theme('dark');
  }
}

// Explicit light theme
:root[data-theme-setting='light'] {

  // Dark header, light content (when header-inverse=true)
  &[data-header-inverse='true'] {
    @include apply-root-theme('dark');
    @include apply-content-theme('light');
  }

  // Light everywhere (when header-inverse=false or not set)
  &:not([data-header-inverse='true']) {
    @include apply-root-theme('light');
  }
}

// Explicit dark theme
:root[data-theme-setting='dark'] {

  // Light header, dark content (when header-inverse=true)
  &[data-header-inverse='true'] {
    @include apply-root-theme('light');
    @include apply-content-theme('dark');
  }

  // Dark everywhere (when header-inverse=false or not set)
  &:not([data-header-inverse='true']) {
    @include apply-root-theme('dark');
  }
}

body {
  background-color: $background;
  block-size: 100%;
  margin: 0;
  padding: 0;
}

// ==========================================
// Global Layout Variables
// Centralized spacing for consistent layouts
// ==========================================
:root {
  --page-padding: #{$spacing-05};
  --page-gap: #{$spacing-05};
  --section-gap: #{$spacing-06};
  --card-padding: #{$spacing-05};

  @media (max-width: 672px) {
    --page-padding: #{$spacing-04};
    --page-gap: #{$spacing-04};
    --section-gap: #{$spacing-05};
    --card-padding: #{$spacing-04};
  }
}

// ==========================================
// SideNav Border
// ==========================================
.cds--side-nav {
  border-right: 1px solid $border-subtle-01;
}

// ==========================================
// Global Tile / Card Visual Containment
// Adds subtle border so cards are visually distinct from the background
// ==========================================
.cds--tile {
  border: 1px solid $border-subtle-01;
}

// DataTable containers inside pages get card treatment
.cds--data-table-container {
  border: 1px solid $border-subtle-01;
}

// ==========================================
// App Content - Main content area below header
// Carbon's Content component uses .cds--content class
// ==========================================
.cds--content,
.app-main-content {
  // Margin-left to offset from expanded SideNav (256px)
  margin-left: 256px;
  // Global padding for consistent spacing across all pages
  padding: $spacing-07;
  min-height: calc(100vh - 48px);
  background-color: $background;

  // Responsive: On smaller screens, no SideNav offset
  @media (max-width: 1055px) {
    margin-left: 0;
  }
}

// ==========================================
// Standard Page Layout
// All main pages inherit this for consistent spacing
// ==========================================
.page-layout {
  padding: var(--page-padding);
  display: flex;
  flex-direction: column;
  gap: var(--page-gap);
  min-height: 100%;
}

// ==========================================
// Public Layout Content - No sidebar, full width
// Used for home/landing page
// ==========================================
.public-layout-content {
  margin-left: 0 !important;
  padding: $spacing-05;
  min-height: calc(100vh - 48px);
  background-color: $background;
}

// ==========================================
// Auth Layout Content - No sidebar, centered
// Used for login, register, forgot password
// ==========================================
.auth-layout-content {
  margin-left: 0 !important;
  padding: 0;
  min-height: calc(100vh - 48px);
  background-color: $background;
  display: flex;
  align-items: center;
  justify-content: center;
}

// ==========================================
// Auth Header Account Dropdown
// ==========================================
.auth-header-account {
  position: relative;
}

.auth-header-chevron {
  margin-left: $spacing-02;
}

.auth-header-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  min-width: 200px;
  background-color: $layer-01;
  border: 1px solid $border-subtle-01;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 9000;
}

.auth-header-dropdown-item {
  display: flex;
  align-items: center;
  gap: $spacing-03;
  width: 100%;
  padding: $spacing-04 $spacing-05;
  background: transparent;
  border: none;
  cursor: pointer;
  @include react.type-style('body-compact-01');
  color: $text-primary;
  text-align: left;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: $layer-hover-01;
  }

  svg {
    color: $icon-secondary;
  }
}

.auth-header-dropdown-divider {
  border: none;
  border-top: 1px solid $border-subtle-01;
  margin: 0;
}

// ==========================================
// Page Title and Description - Consistent styling
// Uses Carbon typography
// ==========================================
.page-title {
  @include react.type-style('productive-heading-05');
  margin-bottom: $spacing-03;
  color: $text-primary;
}

.page-description {
  @include react.type-style('body-long-01');
  color: $text-secondary;
  margin-bottom: $spacing-07;
  max-width: 600px;
}

// ==========================================
// Dashboard and Page Layouts
// ==========================================
.dashboard-page,
.alerts-page,
.alert-detail-page,
.noc-dashboard {
  gap: $spacing-05;

  .cds--grid {
    padding: 0;
  }
}

// ==========================================
// Helper Mixins
// ==========================================
@mixin flex-column {
  display: flex;
  flex-direction: column;
}

// ==========================================
// SideNav User Profile Footer
// Appears at the bottom of the sidebar
// Logout menu slides UP from bottom
// ==========================================
.sidenav-user-footer {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
}

.sidenav-user-profile {
  display: flex;
  align-items: center;
  gap: $spacing-03;
  padding: $spacing-04 $spacing-05;
  cursor: pointer;
  transition: background-color 0.15s ease;
  border-top: 1px solid $border-subtle-01;

  &:hover {
    background-color: $layer-hover-01;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }
}

.sidenav-user-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background-color: $blue-60;
  color: $white-0;
  display: flex;
  align-items: center;
  justify-content: center;
  @include react.type-style('label-01');
  font-weight: 600;
  flex-shrink: 0;
}

.sidenav-user-info {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
}

.sidenav-user-name {
  @include react.type-style('body-compact-01');
  color: $text-primary;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.sidenav-user-role {
  @include react.type-style('helper-text-01');
  color: $text-secondary;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.sidenav-user-chevron {
  color: $icon-secondary;
  flex-shrink: 0;
  transition: transform 0.2s ease;

  &.open {
    transform: rotate(180deg);
  }
}

// Popup menu - Logout
.sidenav-user-menu {
  background-color: $layer-02;
  border-bottom: 1px solid $border-subtle-01;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.2s ease-out;

  &.open {
    max-height: 200px;
  }
}

.sidenav-user-menu-item {
  display: flex;
  align-items: center;
  gap: $spacing-03;
  width: 100%;
  padding: $spacing-04 $spacing-05;
  background: transparent;
  border: none;
  cursor: pointer;
  @include react.type-style('body-compact-01');
  color: $text-primary;
  text-align: left;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: $layer-hover-02;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }

  svg {
    color: $icon-secondary;
  }
}

// ==========================================
// SideNav Link with Badge (Priority Alerts)
// Badge positioned at far right edge
// ==========================================
.sidenav-link-with-badge {
  .cds--side-nav__link-text {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
  }
}

.sidenav-link-text {
  flex: 1;
}

.sidenav-alert-badge {
  margin-left: auto;
  flex-shrink: 0;
}

// ==========================================
// Header Expandable Search
// ==========================================
.header-expandable-search {
  display: flex;
  align-items: center;
  height: 48px;

  &.expanded {
    position: absolute;
    left: 256px; // Account for sidenav width
    right: 48px; // Account for notification icon
    top: 0;
    height: 48px;
    z-index: 8000;

    @media (max-width: 1055px) {
      left: 48px; // Account for hamburger menu only
    }
  }
}

.header-search-expanded {
  display: flex;
  align-items: center;
  width: 100%;
  height: 100%;
  background-color: $layer-01;
  position: relative;
}

.header-search-icon {
  position: absolute;
  left: $spacing-05;
  fill: $icon-secondary;
  pointer-events: none;
}

.header-search-input {
  width: 100%;
  height: 100%;
  padding: 0 $spacing-09 0 $spacing-09;
  border: none;
  background: transparent;
  @include react.type-style('body-compact-01');
  color: $text-primary;

  &::placeholder {
    color: $text-placeholder;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }
}

.header-search-close {
  position: absolute;
  right: 0;
  top: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  background: transparent;
  border: none;
  cursor: pointer;

  svg {
    fill: $icon-secondary;
  }

  &:hover {
    background-color: $layer-hover-01;

    svg {
      fill: $icon-primary;
    }
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }
}

.header-search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background-color: $layer-01;
  border: 1px solid $border-subtle-01;
  border-top: none;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  max-height: 400px;
  overflow-y: auto;
  z-index: 9999;
}

.header-search-result-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: $spacing-04 $spacing-05;
  background: transparent;
  border: none;
  border-bottom: 1px solid $border-subtle-01;
  cursor: pointer;
  text-align: left;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: $layer-hover-01;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }

  &:last-child {
    border-bottom: none;
  }
}

.header-search-result-label {
  @include react.type-style('body-compact-01');
  color: $text-primary;
}

.header-search-result-type {
  @include react.type-style('helper-text-01');
  color: $text-secondary;
  text-transform: capitalize;
}

.header-search-no-results {
  padding: $spacing-05;
  @include react.type-style('body-compact-01');
  color: $text-secondary;
  text-align: center;
}


// ==========================================
// Notification Dropdown
// ==========================================
.notification-dropdown-container {
  position: relative;
  display: flex;
  align-items: center;
}

.notification-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  min-width: 16px;
  height: 16px;
  padding: 0 4px;
  background-color: $support-error;
  color: $text-on-color;
  border-radius: 8px;
  font-size: 10px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
}

.notification-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  width: 360px;
  background-color: $layer-01;
  border: 1px solid $border-subtle-01;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  z-index: 9999;
  border-radius: 0 0 4px 4px;
}

.notification-dropdown-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: $spacing-04 $spacing-05;
  border-bottom: 1px solid $border-subtle-01;
  background-color: $layer-02;
}

.notification-dropdown-title {
  @include react.type-style('heading-compact-01');
  color: $text-primary;
}

.notification-dropdown-count {
  @include react.type-style('label-01');
  color: $text-secondary;
}

.notification-dropdown-list {
  max-height: 320px;
  overflow-y: auto;
}

.notification-dropdown-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: $spacing-07;
  gap: $spacing-03;
  color: $text-secondary;

  svg {
    fill: $support-success;
  }

  span {
    @include react.type-style('body-compact-01');
  }
}

.notification-dropdown-item {
  display: flex;
  align-items: flex-start;
  gap: $spacing-04;
  width: 100%;
  padding: $spacing-04 $spacing-05;
  background: transparent;
  border: none;
  border-bottom: 1px solid $border-subtle-01;
  cursor: pointer;
  text-align: left;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: $layer-hover-01;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }

  &:last-child {
    border-bottom: none;
  }
}

.notification-severity-indicator {
  width: 4px;
  min-height: 40px;
  border-radius: 2px;
  flex-shrink: 0;
}

.notification-content {
  display: flex;
  flex-direction: column;
  gap: 2px;
  flex: 1;
  min-width: 0;
}

.notification-title {
  @include react.type-style('body-compact-01');
  color: $text-primary;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.notification-device {
  @include react.type-style('label-01');
  color: $text-secondary;
}

.notification-time {
  @include react.type-style('helper-text-01');
  color: $text-helper;
}

// ==========================================
// Global Tile Borders
// Consistent subtle border on all Carbon Tiles
// ==========================================
.cds--tile {
  border: 1px solid $border-subtle-01;
}

.notification-dropdown-footer {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: $spacing-04;
  background-color: $layer-02;
  border: none;
  border-top: 1px solid $border-subtle-01;
  cursor: pointer;
  @include react.type-style('body-compact-01');
  color: $link-primary;
  transition: background-color 0.15s ease;

  &:hover {
    background-color: $layer-hover-02;
  }

  &:focus {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }
}
