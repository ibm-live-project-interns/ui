/**
 * Copyright IBM Corp. 2026
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */

@use '@carbon/react' with (
  $css--font-face: false,
  $css--body: true
);
@use '@carbon/react/scss/spacing' as *;
@use '@carbon/react/scss/theme' as *;
@use '@carbon/react/scss/themes';
@use '@carbon/react/scss/colors' as *;

// Extracted component and layout partials
@use './layout/app-content';
@use './components/auth-header-dropdown';
@use './components/sidenav-user-profile';
@use './components/header-search';
@use './components/notification-dropdown';
@use './components/global-search';
@use './components/widgets';
@use './components/error-boundary';

/* Importing the component styles here will load them
   before the JavaScript, which will make the page
   not "flashing style" - everything will be at the right
   place from the start. In most case, avoid loading styles
   from the JavaScript. */

@mixin light-brand {
  --light: 'true';
  --cs-brand: #{$blue-30};
  --cs-brand-alt: #{$blue-20};
  --cs-logo-filter: invert(100%);

  background-color: $background;
  color: $text-primary;
}

@mixin dark-brand {
  --light: 'false';
  --cs-brand: #{$blue-80};
  --cs-brand-alt: #{$blue-90};
  --cs-logo-filter: initial;

  background: $background;
  color: $text-primary;
}

/* Theme based on data-theme-setting attribute */

// Base mixin to apply theme and brand styles
@mixin apply-theme($theme: 'light') {
  @if $theme =='light' {
    @include theme(themes.$g10);
    @include light-brand;
  }

  @else {
    @include theme(themes.$g100);
    @include dark-brand;
  }
}

// Helper mixins to apply theme to root or content
@mixin apply-root-theme($theme: 'light') {
  @include apply-theme($theme);
}

@mixin apply-content-theme($theme: 'light') {
  .cs--content {
    @include apply-theme($theme);
  }
}

// System theme (no explicit setting or explicit 'system' value)
$system-selector: ':root:is(:not([data-theme-setting]), [data-theme-setting="system"])';

// Default: dark header, light content (when header-inverse=true)
#{$system-selector}[data-header-inverse='true'] {
  @include apply-root-theme('dark');
  @include apply-content-theme('light');
}

// Default: light everywhere (when header-inverse=false or not set)
#{$system-selector}:not([data-header-inverse='true']) {
  @include apply-root-theme('light');
}

// System theme with dark preference
@media (prefers-color-scheme: dark) {

  // Light header, dark content (when header-inverse=true)
  #{$system-selector}[data-header-inverse='true'] {
    @include apply-root-theme('light');
    @include apply-content-theme('dark');
  }

  // Dark everywhere (when header-inverse=false or not set)
  #{$system-selector}:not([data-header-inverse='true']) {
    @include apply-root-theme('dark');
  }
}

// Explicit light theme
:root[data-theme-setting='light'] {

  // Dark header, light content (when header-inverse=true)
  &[data-header-inverse='true'] {
    @include apply-root-theme('dark');
    @include apply-content-theme('light');
  }

  // Light everywhere (when header-inverse=false or not set)
  &:not([data-header-inverse='true']) {
    @include apply-root-theme('light');
  }
}

// Explicit dark theme
:root[data-theme-setting='dark'] {

  // Light header, dark content (when header-inverse=true)
  &[data-header-inverse='true'] {
    @include apply-root-theme('light');
    @include apply-content-theme('dark');
  }

  // Dark everywhere (when header-inverse=false or not set)
  &:not([data-header-inverse='true']) {
    @include apply-root-theme('dark');
  }
}

body {
  background-color: $background;
  block-size: 100%;
  margin: 0;
  padding: 0;
}

// ==========================================
// Global Layout Variables
// Centralized spacing for consistent layouts
// ==========================================
:root {
  --page-padding: #{$spacing-05};
  --page-gap: #{$spacing-05};
  --section-gap: #{$spacing-06};
  --card-padding: #{$spacing-05};

  @media (max-width: 672px) {
    --page-padding: #{$spacing-04};
    --page-gap: #{$spacing-04};
    --section-gap: #{$spacing-05};
    --card-padding: #{$spacing-04};
  }
}

// ==========================================
// SideNav Border
// ==========================================
.cds--side-nav {
  border-right: 1px solid $border-subtle-01;
}

// ==========================================
// Global Tile / Card Visual Containment
// Adds subtle border so cards are visually distinct from the background
// ==========================================
.cds--tile {
  border: 1px solid $border-subtle-01;
}

// DataTable containers inside pages get card treatment
.cds--data-table-container {
  border: 1px solid $border-subtle-01;
}

// ==========================================
// Small Screen / Phone Breakpoint (< 480px)
// Tighten spacing and force single-column grids
// ==========================================
@media (max-width: 480px) {
  .cds--content,
  .app-main-content {
    padding: $spacing-05;
  }

  .page-layout {
    padding: $spacing-03;
    gap: $spacing-03;
  }

  .kpi-row {
    gap: $spacing-04;
  }

  .page-title {
    @include react.type-style('productive-heading-04');
  }

  .page-description {
    margin-bottom: $spacing-05;
  }
}
