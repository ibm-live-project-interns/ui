@use '@carbon/react/scss/spacing' as *;
@use '@carbon/react/scss/theme' as *;
@use '@carbon/react' as react;
@use '@carbon/colors' as *;

// ==========================================
// Page Layout - FULL WIDTH
// ==========================================
.alert-details-page {
    padding: 0;
    width: 100%;
    max-width: 100%;
    position: relative;

    &--loading {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 400px;
    }

    &__skeleton {
        @include react.type-style('body-01');
        color: $text-secondary;
    }

    // Toast notifications - appears at top center
    &__toast-container {
        position: fixed;
        top: 56px; // Below header
        left: 50%;
        transform: translateX(-50%);
        z-index: 9999;
        display: flex;
        flex-direction: column;
        gap: $spacing-03;
        max-width: 500px;
        width: 100%;
        padding: 0 $spacing-05;

        .cds--toast-notification {
            margin: 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
        }
    }
}

// ==========================================
// Breadcrumb
// ==========================================
.alert-details-page__breadcrumb {
    padding: $spacing-05;
    margin-bottom: 0;

    .cds--breadcrumb-item a {
        @include react.type-style('body-compact-01');
        color: $link-primary;
        text-decoration: none;

        &:hover {
            text-decoration: underline;
        }
    }
}

// Content Wrapper - global padding is applied in index.scss
.alert-details-page__content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: $spacing-06;
}

// ==========================================
// Header
// ==========================================
.alert-details-page__header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: $spacing-05;
    margin-bottom: $spacing-05;
    background-color: $layer-01;
    border-bottom: 1px solid $border-subtle-01;
    gap: $spacing-05;
    flex-wrap: wrap;
}

.alert-details-page__header-left {
    display: flex;
    align-items: flex-start;
    gap: $spacing-04;
    flex: 1;
    min-width: 0;
}

.alert-details-page__header-content {
    display: flex;
    flex-direction: column;
    gap: $spacing-02;
}

.alert-details-page__title {
    @include react.type-style('productive-heading-04');
    margin: 0;
    color: $text-primary;
}

.alert-details-page__subtitle {
    @include react.type-style('body-compact-01');
    color: $text-secondary;
    margin: 0;
}

.alert-details-page__header-right {
    display: flex;
    gap: $spacing-03;
}

// ==========================================
// KPI Row
// ==========================================
.alert-kpi-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: $spacing-05;

    @media (max-width: 1056px) {
        grid-template-columns: repeat(2, 1fr);
    }

    @media (max-width: 672px) {
        grid-template-columns: 1fr;
    }
}

.alert-kpi-tile {
    display: flex;
    align-items: flex-start;
    gap: $spacing-05;
    min-height: 120px;

    &--severity {
        border-left: 4px solid $red-60;
    }
}

.alert-kpi-icon {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &--red {
        background: rgba($red-60, 0.15);
        color: $red-60;
    }

    &--purple {
        background: rgba($purple-50, 0.15);
        color: $purple-50;
    }

    &--blue {
        background: rgba($blue-60, 0.15);
        color: $blue-60;
    }

    &--orange {
        background: rgba($orange-40, 0.15);
        color: $orange-40;
    }
}

.alert-kpi-content {
    display: flex;
    flex-direction: column;
    gap: $spacing-02;
    flex: 1;
}

.alert-kpi-label {
    @include react.type-style('label-01');
    color: $text-secondary;
    text-transform: uppercase;
}

.alert-kpi-value {
    @include react.type-style('productive-heading-04');
    margin: 0;
    color: $text-primary;
}

.alert-kpi-subtitle {
    @include react.type-style('helper-text-01');
    color: $text-secondary;
}

.alert-kpi-progress {
    width: 100%;
    max-width: 160px;
}

// ==========================================
// Content Grid - SMART ROW-BY-ROW MATCHING
// ==========================================
.alert-details-page__content-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: $spacing-05;
    padding: 0 0 $spacing-07;
    // Key: Each row independently matches its tallest card
    align-items: start;

    @media (max-width: 1056px) {
        grid-template-columns: 1fr;
    }
}

// Rows that should match heights side-by-side
.alert-details-page__row {
    display: grid;
    grid-column: 1 / -1; // Span both columns
    grid-template-columns: repeat(2, 1fr);
    gap: $spacing-05;
    align-items: stretch; // Match heights within row
    margin-bottom: $spacing-05;

    &:last-child {
        margin-bottom: 0;
    }

    @media (max-width: 1056px) {
        grid-template-columns: 1fr;
        align-items: start;
    }
}

// ==========================================
// Universal Card Styles
// ==========================================
.alert-card {
    display: flex;
    flex-direction: column;
    border: 1px solid $border-subtle-01;
}

.alert-card__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: $spacing-03;
    margin-bottom: $spacing-05;
    padding-bottom: $spacing-04;
    border-bottom: 1px solid $border-subtle-01;
    flex-shrink: 0;

    svg {
        color: $icon-primary;
        flex-shrink: 0;
    }
}

.alert-card__icon {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: rgba($purple-50, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    color: $purple-50;
    flex-shrink: 0;
}

.alert-card__title {
    @include react.type-style('productive-heading-02');
    margin: 0;
    color: $text-primary;
    flex: 1;
}

// Code Block
.alert-card__code {
    background-color: $layer-02;
    border-radius: 4px;
    padding: $spacing-05;
    margin: 0 0 $spacing-04;
    overflow-x: auto;

    code {
        @include react.type-style('code-01');
        color: $text-primary;
        white-space: pre-wrap;
        word-break: break-word;
        line-height: 1.5;
        display: block;
    }
}

.alert-card__footer {
    display: flex;
    gap: $spacing-06;
    flex-wrap: wrap;
    flex-shrink: 0;
}

.alert-card__meta {
    display: flex;
    align-items: center;
    gap: $spacing-03;
    @include react.type-style('label-01');
    color: $text-secondary;

    svg {
        color: $icon-secondary;
        flex-shrink: 0;
    }
}

// Device Info Rows
.alert-card__rows {
    display: flex;
    flex-direction: column;
    flex: 1;
}

.alert-card__row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: $spacing-04 0;
    border-bottom: 1px solid $border-subtle-01;
    gap: $spacing-05;

    &:last-child {
        border-bottom: none;
    }
}

.alert-card__label {
    @include react.type-style('body-compact-01');
    color: $text-secondary;
    min-width: 140px;
    flex-shrink: 0;
}

.alert-card__value {
    @include react.type-style('body-compact-01');
    color: $text-primary;
    text-align: right;
    word-break: break-word;

    &--highlight {
        color: $blue-60;
        font-weight: 600;
    }
}

// AI Explanation Sections
.alert-card__section {
    margin-bottom: $spacing-06;

    &:last-child {
        margin-bottom: 0;
    }
}

.alert-card__section-title {
    @include react.type-style('productive-heading-01');
    color: $text-primary;
    margin-bottom: $spacing-04;
    text-transform: uppercase;
    font-size: 12px;
    letter-spacing: 0.32px;

    &--impact {
        color: $orange-40;
    }

    &--actions {
        color: $red-60;
    }
}

.alert-card__text {
    @include react.type-style('body-long-01');
    color: $text-primary;
    margin: 0;
    line-height: 1.625;
}

.alert-card__list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: $spacing-04;
}

.alert-card__list-item {
    display: flex;
    align-items: flex-start;
    gap: $spacing-03;
    @include react.type-style('body-compact-01');
    color: $text-primary;
    line-height: 1.5;
}

.alert-card__list-icon {
    color: $green-50;
    flex-shrink: 0;
    margin-top: 2px;
}

.alert-card__impact-box {
    display: flex;
    align-items: flex-start;
    gap: $spacing-04;
    padding: $spacing-05;
    background-color: rgba($orange-40, 0.05);
    border-radius: 4px;
    border-left: 4px solid $orange-40;
    @include react.type-style('body-compact-01');
    color: $text-primary;
    line-height: 1.5;

    svg {
        color: $orange-40;
        flex-shrink: 0;
        margin-top: 2px;
    }
}

.alert-card__actions-list {
    display: flex;
    flex-direction: column;
    gap: $spacing-04;
}

.alert-card__action-item {
    display: flex;
    align-items: flex-start;
    gap: $spacing-04;
    @include react.type-style('body-compact-01');
    color: $text-primary;
    line-height: 1.5;
}

.alert-card__action-number {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background-color: $layer-accent-01;
    display: flex;
    align-items: center;
    justify-content: center;
    @include react.type-style('label-01');
    font-weight: 600;
    flex-shrink: 0;
    color: $text-primary;
}

// Historical Alerts
.alert-card__historical-list {
    display: flex;
    flex-direction: column;
    gap: $spacing-04;
    margin-bottom: $spacing-05;
}

.alert-card__historical-item {
    padding: $spacing-05;
    background-color: $layer-02;
    border-radius: 4px;
    border: 1px solid $border-subtle-01;
    cursor: pointer;
    transition: all 0.15s ease;
    text-align: left;
    width: 100%;

    &:hover {
        background-color: $layer-hover-02;
        border-color: $border-strong-01;
    }

    &:focus {
        outline: 2px solid $focus;
        outline-offset: -2px;
    }
}

.alert-card__historical-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: $spacing-03;
    gap: $spacing-04;
}

.alert-card__historical-timestamp {
    @include react.type-style('label-01');
    color: $text-secondary;
}

.alert-card__historical-title {
    @include react.type-style('body-compact-01');
    font-weight: 600;
    color: $text-primary;
    margin: 0 0 $spacing-02;
}

.alert-card__historical-resolution {
    @include react.type-style('helper-text-01');
    color: $text-secondary;
    margin: 0;
}

.alert-card__view-all {
    width: 100%;
    justify-content: space-between;
    flex-shrink: 0;
}

// Alert Actions
.alert-actions {
    display: flex;
    gap: $spacing-03;
    flex-wrap: wrap;
}

// ==========================================
// Raw Trap Data Component
// ==========================================
.raw-trap-data {
    display: flex;
    flex-direction: column;
    border: 1px solid $border-subtle-01;

    &__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: $spacing-04;
        padding-bottom: $spacing-03;
        border-bottom: 1px solid $border-subtle-01;
    }

    &__title {
        @include react.type-style('productive-heading-02');
        margin: 0;
        color: $text-primary;
    }

    &__content {
        background-color: $gray-100;
        border-radius: 4px;
        padding: $spacing-05;
        margin: 0 0 $spacing-04;
        overflow-x: auto;
        max-height: 400px;
        overflow-y: auto;

        code {
            @include react.type-style('code-01');
            color: $green-40;
            white-space: pre-wrap;
            word-break: break-word;
            line-height: 1.6;
            font-size: 13px;
            display: block;
        }

        // SNMP OID highlighting
        .oid {
            color: $cyan-40;
        }

        .value {
            color: $white;
        }
    }

    &__footer {
        display: flex;
        gap: $spacing-06;
        flex-wrap: wrap;
        padding-top: $spacing-03;
        border-top: 1px solid $border-subtle-01;
    }

    &__meta {
        display: flex;
        align-items: center;
        gap: $spacing-03;
        @include react.type-style('label-01');
        color: $text-secondary;

        svg {
            color: $icon-secondary;
            flex-shrink: 0;
        }
    }
}

// ==========================================
// SNMP Trap Data Specific Formatting
// ==========================================
.snmp-trap-formatted {
    font-family: 'IBM Plex Mono', 'Menlo', 'Monaco', monospace;

    &__section {
        margin-bottom: $spacing-04;

        &:last-child {
            margin-bottom: 0;
        }
    }

    &__label {
        color: $cyan-40;
        font-weight: 600;
    }

    &__value {
        color: $white;
    }

    &__oid {
        color: $yellow-40;
    }

    &__string {
        color: $green-40;
    }

    &__number {
        color: $purple-40;
    }

    &__timestamp {
        color: $orange-40;
    }
}

// Responsive
@media (max-width: 672px) {
    .alert-details-page__header {
        flex-direction: column;
    }

    .alert-details-page__header-right {
        width: 100%;
    }

    .alert-kpi-tile {
        min-height: auto;
    }

    .raw-trap-data__content {
        max-height: 300px;
    }
}
